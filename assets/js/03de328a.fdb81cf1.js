(self.webpackChunkkubevela_io=self.webpackChunkkubevela_io||[]).push([[17027],{3905:function(e,t,r){"use strict";r.d(t,{Zo:function(){return l},kt:function(){return d}});var i=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,i,n=function(e,t){if(null==e)return{};var r,i,n={},a=Object.keys(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var g=i.createContext({}),c=function(e){var t=i.useContext(g),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},l=function(e){var t=c(e.components);return i.createElement(g.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},p=i.forwardRef((function(e,t){var r=e.components,n=e.mdxType,a=e.originalType,g=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),p=c(r),d=n,f=p["".concat(g,".").concat(d)]||p[d]||u[d]||a;return r?i.createElement(f,o(o({ref:t},l),{},{components:r})):i.createElement(f,o({ref:t},l))}));function d(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=r.length,o=new Array(a);o[0]=p;var s={};for(var g in t)hasOwnProperty.call(t,g)&&(s[g]=t[g]);s.originalType=e,s.mdxType="string"==typeof e?e:n,o[1]=s;for(var c=2;c<a;c++)o[c]=r[c];return i.createElement.apply(null,o)}return i.createElement.apply(null,r)}p.displayName="MDXCreateElement"},25920:function(e,t,r){"use strict";r.r(t),r.d(t,{frontMatter:function(){return o},metadata:function(){return s},toc:function(){return g},default:function(){return l}});var i=r(22122),n=r(19756),a=(r(67294),r(3905)),o={title:"Integrate with CI system by Triggers",description:"Integrate with CI system by Triggers"},s={unversionedId:"how-to/dashboard/trigger/overview",id:"version-v1.2/how-to/dashboard/trigger/overview",isDocsHomePage:!1,title:"Integrate with CI system by Triggers",description:"Integrate with CI system by Triggers",source:"@site/versioned_docs/version-v1.2/how-to/dashboard/trigger/overview.md",sourceDirName:"how-to/dashboard/trigger",slug:"/how-to/dashboard/trigger/overview",permalink:"/docs/v1.2/how-to/dashboard/trigger/overview",editUrl:"https://github.com/oam-dev/kubevela.io/edit/main/docs/how-to/dashboard/trigger/overview.md",version:"v1.2",lastUpdatedBy:"Wei (\u6bb5\u5c11)",lastUpdatedAt:1644832389,formattedLastUpdatedAt:"2/14/2022",frontMatter:{title:"Integrate with CI system by Triggers",description:"Integrate with CI system by Triggers"},sidebar:"version-v1.2/docs",previous:{title:"Manage Traits",permalink:"/docs/v1.2/how-to/dashboard/trait/overview"},next:{title:"Manage Targets",permalink:"/docs/v1.2/how-to/dashboard/target/overview"}},g=[{value:"Custom Trigger",id:"custom-trigger",children:[]},{value:"Harbor Trigger",id:"harbor-trigger",children:[]},{value:"ACR Trigger",id:"acr-trigger",children:[]},{value:"DockerHub Trigger",id:"dockerhub-trigger",children:[]},{value:"JFrog Trigger",id:"jfrog-trigger",children:[]}],c={toc:g};function l(e){var t=e.components,o=(0,n.Z)(e,["components"]);return(0,a.kt)("wrapper",(0,i.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"After you have created an application, a default trigger is automatically created. You can also delete or create a new trigger."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"default-trigger",src:r(68503).Z})),(0,a.kt)("p",null,"KubeVela triggers can integrate with any CI tool like Gitlab CI, Jenkins Pipeline or image registry like Harbor or ACR."),(0,a.kt)("p",null,"We now support five types of triggers: Custom, ACR, Harbor, DockerHub and JFrog."),(0,a.kt)("h2",{id:"custom-trigger"},"Custom Trigger"),(0,a.kt)("p",null,"Custom triggers will provide a webhook URL, which you can use to integrate with your CI tool using the specified request body."),(0,a.kt)("p",null,"The default trigger is a custom trigger, click ",(0,a.kt)("inlineCode",{parentName:"p"},"Manual Trigger")," to get more info of this trigger:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"manual-trigger",src:r(78711).Z})),(0,a.kt)("p",null,"Webhook URL is the address of this trigger, you can see request body in ",(0,a.kt)("inlineCode",{parentName:"p"},"Curl Command")," example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'  {\n    // required, the upgrade of this deployment\n    "upgrade": {\n      // key is the name of application\n      "<application-name>": {\n        // the fields that need to be patched\n        "image": "<image-name>"\n      }\n    },\n    // optional, the code info of this deployment\n    "codeInfo": {\n      "commit": "<commit-id>",\n      "branch": "<branch>",\n      "user": "<user>",\n    }\n  }\n')),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"upgrade")," is the key of the object that need to be patched, ",(0,a.kt)("inlineCode",{parentName:"p"},"<application-name>")," is the name of application. ",(0,a.kt)("inlineCode",{parentName:"p"},"image")," is the field that need to be patched. You can also add more fields in ",(0,a.kt)("inlineCode",{parentName:"p"},"<application-name>"),"."),(0,a.kt)("p",null,"In ",(0,a.kt)("inlineCode",{parentName:"p"},"codeInfo"),", you can add some code infos of this deployment like commit id, branch or user."),(0,a.kt)("p",null,"Below is an example of using Custom Trigger in Gitlab CI, we use env in this example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},'webhook-request:\n  stage: request\n  before_script:\n    - apk add --update curl && rm -rf /var/cache/apk/*\n  script:\n    - |\n      curl -X POST -H "Content-Type: application/json" -d \'{"upgrade":{"\'"$APP_NAME"\'":{"image":"\'"$BUILD_IMAGE"\'"}},"codeInfo":{"user":"\'"$CI_COMMIT_AUTHOR"\'","commit":"\'"$CI_COMMIT_SHA"\'","branch":"\'"$CI_COMMIT_BRANCH"\'"}}\' $WEBHOOK_URL\n')),(0,a.kt)("p",null,"After CI have executed this step, we can see that application is deployed successfully in VelaUX. We can also see some relative code infos of this deployment."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"gitlab-trigger",src:r(32246).Z})),(0,a.kt)("h2",{id:"harbor-trigger"},"Harbor Trigger"),(0,a.kt)("p",null,"Harbor Trigger can be integrated with Harbor image registry."),(0,a.kt)("p",null,"We can start with creating a new harbor trigger. The Payload Type is Harbor, and the Execution Workflow is the workflow you want to deploy in the trigger."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(20874).Z})),(0,a.kt)("p",null,"After creating the trigger, we can setup this trigger in Harbor:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(46563).Z})),(0,a.kt)("p",null,"After configuring the trigger, we can see the new deploy revisions when a new image is pushed to the registry."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(65625).Z})),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(42124).Z})),(0,a.kt)("h2",{id:"acr-trigger"},"ACR Trigger"),(0,a.kt)("p",null,"ACR Trigger can be integrated with ACR image registry."),(0,a.kt)("p",null,"We can start with creating a new ACR trigger. The Payload Type is ACR, and the Execution Workflow is the workflow you want to deploy in the trigger."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(311).Z})),(0,a.kt)("p",null,"After creating the trigger, we can setup this trigger in ACR:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(68565).Z})),(0,a.kt)("p",null,"After configuring the trigger, we can see the new deploy revisions when a new image is pushed to the registry."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(10256).Z})),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(83399).Z})),(0,a.kt)("h2",{id:"dockerhub-trigger"},"DockerHub Trigger"),(0,a.kt)("p",null,"DockerHub Trigger can be integrated with DockerHub."),(0,a.kt)("p",null,"We can start with creating a new DockerHub trigger. The Payload Type is DockerHub, and the Execution Workflow is the workflow you want to deploy in the trigger."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(48601).Z})),(0,a.kt)("p",null,"After creating the trigger, we can setup this trigger in DockerHub:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(86063).Z})),(0,a.kt)("p",null,"After configuring the trigger, we can see the new deploy revisions when a new image is pushed to the registry."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(6348).Z})),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(17497).Z})),(0,a.kt)("h2",{id:"jfrog-trigger"},"JFrog Trigger"),(0,a.kt)("p",null,"jFrog Trigger can be integrated with JFrog Artifactory."),(0,a.kt)("p",null,"We can start with creating a new jFrog trigger. The Payload Type is jFrog, and the Execution Workflow is the workflow you want to deploy in the trigger."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(4509).Z})),(0,a.kt)("p",null,"After creating the trigger, we can setup this trigger in jFrog:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"alt",src:r(12089).Z})),(0,a.kt)("p",null,"After configuring the trigger, we can see the new deploy revisions when a new image is pushed to the registry."),(0,a.kt)("p",null,"Note: jFrog webhook callback has no jFrog address, KubeVela will recognize the request header ",(0,a.kt)("inlineCode",{parentName:"p"},"X-jFrogURL")," as jFrog address and use it in application ",(0,a.kt)("inlineCode",{parentName:"p"},"image")," field."))}l.isMDXComponent=!0},10256:function(e,t,r){"use strict";t.Z=r.p+"assets/images/acr-trigger-acrrecord-0ce59eca57f0502eeeb400dc2fa8be68.png"},311:function(e,t,r){"use strict";t.Z=r.p+"assets/images/acr-trigger-newtrigger-e90baae3b3d802bdd7d5686a34c671cf.png"},83399:function(e,t,r){"use strict";t.Z=r.p+"assets/images/acr-trigger-revisions-73076829d1ee5a56648380381f1c0741.png"},68565:function(e,t,r){"use strict";t.Z=r.p+"assets/images/acr-trigger-ff30870e9bb413a28cf96b8604853988.png"},68503:function(e,t,r){"use strict";t.Z=r.p+"assets/images/default-trigger-2d679f182f58a72090474f3b0d343dd7.png"},6348:function(e,t,r){"use strict";t.Z=r.p+"assets/images/dockerhub-trigger-dockerhubrecord-a979f6ff14b771e6c12996c7c77463bb.png"},48601:function(e,t,r){"use strict";t.Z=r.p+"assets/images/dockerhub-trigger-newtrigger-c5069e4c7ce9c10d2970f66d2292c903.png"},17497:function(e,t,r){"use strict";t.Z=r.p+"assets/images/dockerhub-trigger-revisions-92f0c9aa21ee7c7bf587575583d916b0.png"},86063:function(e,t,r){"use strict";t.Z=r.p+"assets/images/dockerhub-trigger-3fe092950e8c89580780e6d5ddbbff0f.png"},32246:function(e,t,r){"use strict";t.Z=r.p+"assets/images/gitlab-trigger-89a8a953cfbe5dcf1ed118ca20f3c71e.png"},65625:function(e,t,r){"use strict";t.Z=r.p+"assets/images/harbor-trigger-harborrecord-f644ee54d5904f4d0cca7c9b54811721.png"},20874:function(e,t,r){"use strict";t.Z=r.p+"assets/images/harbor-trigger-newtrigger-1294a428077c9ce0e981d2ab1e27f4ad.png"},42124:function(e,t,r){"use strict";t.Z=r.p+"assets/images/harbor-trigger-revisions-6c7e199a9e928cd3f0f4b30a4159613d.png"},46563:function(e,t,r){"use strict";t.Z=r.p+"assets/images/harbor-trigger-6bba927c7425b4524c0d9f2c7a228a50.png"},4509:function(e,t,r){"use strict";t.Z=r.p+"assets/images/jfrog-trigger-newtrigger-21a9620c3b53de4dd57b1a088731d62d.png"},12089:function(e,t,r){"use strict";t.Z=r.p+"assets/images/jfrog-trigger-80f70a626e34d20421dce8fa376aba7c.png"},78711:function(e,t,r){"use strict";t.Z=r.p+"assets/images/manual-trigger-8361fea9230d5f56d649dca15a33f1db.png"}}]);